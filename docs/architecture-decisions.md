# Architecture Decisions (ADR)

## ADR-001: Асинхронный пайплайн
**Решение:** тяжелые этапы (ASR, сегментация, кадры) выполняются воркерами через очередь.  
**Причина:** предсказуемость нагрузки, устойчивость к сбоям, масштабируемость.  
**Альтернативы:** синхронная обработка в API (отклонено из-за времени и риска таймаутов).

## ADR-002: Поддержка локальных моделей
**Решение:** ASR/LLM поддерживаются через абстракцию провайдера с режимами `local`/`remote`.  
**Причина:** контроль стоимости и возможность офлайн-развертывания.  
**Альтернативы:** только внешние API (отклонено из-за затрат и зависимости).

## ADR-003: Хранение артефактов в S3
**Решение:** видео и кадры в объектном storage (S3-compatible).  
**Причина:** дешево и масштабируемо.  
**Альтернативы:** файловая система (отклонено для продакшена).

## ADR-004: Ретенция по умолчанию
**Решение:** raw видео/аудио — 7 дней, кадры/экспорты — 30 дней.  
**Причина:** баланс стоимости и удобства.  
**Альтернативы:** бесконечное хранение (отклонено из-за стоимости).

## ADR-005: Модель доступа и шаринг
**Решение:** приватные гайды по умолчанию, шаринг по ссылке read-only.  
**Причина:** простой MVP и минимизация рисков утечки.  
**Альтернативы:** публичные гайды по умолчанию (отклонено из-за приватности).

## ADR-006: Enforcement лимитов
**Решение:** проверки лимитов на уровне API и повторно на уровне ingest.  
**Причина:** защита от злоупотреблений и ошибок клиента.  
**Альтернативы:** только на API (отклонено из-за гонок и обхода).
